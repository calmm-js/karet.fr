!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("karet.lift"),require("infestines"),require("kefir"),require("kefir.partial.lenses")):"function"==typeof define&&define.amd?define(["exports","karet.lift","infestines","kefir","kefir.partial.lenses"],r):r((e.karet=e.karet||{},e.karet.fr={}),e.karet.lift,e.I,e.Kefir,e.kefir.partial.lenses)}(this,function(e,n,a,s,f){"use strict";function r(o){var t=i(function(i){return s.stream(function(e){var t=e.emit,r=e.end,n=new FileReader,a={fr:n,state:u,event:u};return d.forEach(function(r){n.addEventListener(r,function(e){t(a=f.set("state",{type:r,event:e},a))})}),n.addEventListener("loadend",function(e){r(t(a=f.set("event",e,a)))}),n[o](i),function(){n.readyState<2&&n.abort()}})});return i(function(e){var r=n.combine([e],a.id);return(r!=e?r.flatMapLatest(t):t(r)).toProperty()})}var t=a.curry(function(e,r){if(r instanceof s.Observable)return r.filter(e);if(e(r))return r;throw Error(e.name)}),i=function(e){return e},d=["loadstart","progress","load","error"],u={type:"initial"},o=a.curryN(3,function(e,r){return a.pipe2U(t(e),r)}),l=a.curry(function(e,r){return e.includes(r)}),c=function(e){return f.get(["state","type",l(e)])},p=function(e){return i(f.get(["fr",e]))},y=function(e){return i(f.get(["state","event",e]))},v=r("readAsArrayBuffer"),k=r("readAsBinaryString"),g=r("readAsDataURL"),A=r("readAsText"),h=i(c(["load","error"])),m=i(c(["error"])),S=i(c(d)),b=i(c(["load"])),x=a.defineNameU(f.get(["event","type",f.is("loadend")]),"isDone"),E=i(c(["progress","loadstart"])),L=y("loaded"),q=p("readyState"),B=y("total"),D=o(x,p("result")),U=o(x,p("error"));e.readAsArrayBuffer=v,e.readAsBinaryString=k,e.readAsDataURL=g,e.readAsText=A,e.hasEnded=h,e.hasFailed=m,e.hasStarted=S,e.hasSucceeded=b,e.isDone=x,e.isProgressing=E,e.loaded=L,e.readyState=q,e.total=B,e.result=D,e.error=U,Object.defineProperty(e,"__esModule",{value:!0})});
